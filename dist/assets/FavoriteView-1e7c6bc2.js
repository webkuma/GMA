import{n as S,r as i,u as C,o as D,p as j,a as r,b as l,d as e,e as f,w as B,f as E,t as h,F as L,j as R,h as F,k as I,L as N,R as V,q,l as m,i as $}from"./index-2a38b5bf.js";const T={class:"text-white"},z={key:0,class:"absolute w-full h-full bg-[#202020] bg-opacity-90"},M={class:"flex items-center justify-center h-full"},O={key:1},P={class:"m-4 flex justify-between items-center"},Y={class:"flex justify-between items-center p-3 text-gray-700 border border-gray-200 rounded-lg bg-gray-50","aria-label":"Breadcrumb"},W={class:"inline-flex items-center space-x-1 md:space-x-2 rtl:space-x-reverse"},Z={class:"inline-flex items-center"},A=e("a",{href:"#",class:"inline-flex items-center text-sm font-medium text-gray-700 hover:text-blue-600 dark:text-gray-400 dark:hover:text-white"},[e("svg",{class:"w-3 h-3 me-2","aria-hidden":"true",xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",viewBox:"0 0 20 20"},[e("path",{d:"m19.707 9.293-2-2-7-7a1 1 0 0 0-1.414 0l-7 7-2 2a1 1 0 0 0 1.414 1.414L2 10.414V18a2 2 0 0 0 2 2h3a1 1 0 0 0 1-1v-4a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1v4a1 1 0 0 0 1 1h3a2 2 0 0 0 2-2v-7.586l.293.293a1 1 0 0 0 1.414-1.414Z"})]),m(" 首頁 ")],-1),H=e("li",null,[e("div",{class:"flex items-center"},[e("svg",{class:"rtl:rotate-180 block w-3 h-3 mx-1 text-gray-400","aria-hidden":"true",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 6 10"},[e("path",{stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"m1 9 4-4-4-4"})]),e("a",{class:"ms-1 text-sm font-medium text-gray-700 hover:text-blue-600 md:ms-2 dark:text-gray-400 dark:hover:text-white"}," 收藏 ")])],-1),J={class:"m-4"},K={class:"border-b-4 border-custom-gold"},Q=e("span",{class:"text-2xl"},"已收藏的作品",-1),U={class:"mx-6 grid grid-cols-1 lg:grid-cols-2 gap-4"},G={class:"flex items-center justify-end mr-4"},X=["onClick"],ee=e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"m9.75 9.75 4.5 4.5m0-4.5-4.5 4.5M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"},null,-1),te={class:"mr-4 w-20 h-20 sm:w-32 sm:h-32 rounded-lg aspect-square",alt:""},se={class:"flex flex-col justify-evenly pl-2"},ae={class:""},oe={class:"text-base sm:text-xl font-semibold text-gray-700"},re={class:"text-base sm:text-xl font-semibold text-gray-700"},le={class:"text-base font-semibold text-gray-500"},ne={key:0,class:"p-4"},de={__name:"FavoriteView",setup(ie){const _=S(),c=i(1),x=C(),w=i(),n=i(),v=i(),p=i();D(async()=>{c.value=1,await x.isReady(),b()});async function y(){const s=await I({locateFile:u=>`https://sql.js.org/dist/${u}`}),a=fetch("/backend/music.db").then(u=>u.arrayBuffer()),[t,o]=await Promise.all([s,a]),d=new t.Database(new Uint8Array(o));return w.value=d,d}async function b(){v.value=Object.keys(localStorage).filter(t=>t.startsWith("favoriteStorage-")).map(t=>parseInt(t.replace("favoriteStorage-",""),10));const a=(await y()).exec(`SELECT DISTINCT * FROM shortlist WHERE id IN (${v.value.join(", ")}) ORDER BY year DESC`);a[0]?(n.value=a[0].values.map(t=>({id:t[0],awards:t[1],nominee:t[2],work:t[3],year:t[4],won:t[5],url:t[6],isStoraged:!!localStorage.getItem(`favoriteStorage-${t[0]}`)})),c.value=0):(p.value=!0,c.value=0)}function k(s){n.value.forEach(a=>{a.id==s&&(a.isStoraged=!1,localStorage.removeItem(`favoriteStorage-${s}`),_.updateYearsDataStorage(s,!1),g())})}function g(){let s=0;return n.value&&n.value.forEach(a=>{a.isStoraged&&s++}),s}return(s,a)=>{const t=j("lazy");return r(),l("main",T,[c.value===1?(r(),l("div",z,[e("div",M,[f(N)])])):(r(),l("div",O,[e("div",P,[e("nav",Y,[e("ol",W,[e("li",Z,[f(E(V),{to:"/",class:"inline-block"},{default:B(()=>[A]),_:1})]),H])])]),e("div",J,[e("span",K,[Q,e("span",null," ("+h(g())+")",1)])]),e("div",U,[(r(!0),l(L,null,R(n.value,(o,d)=>(r(),l("div",{key:d,class:q(["flex shadow-custom-inner shadow-yellow-500 mt-4 p-4 border rounded-lg",{"bg-[#F5E8C7]":o.won,"bg-gray-200 ":!o.won,hidden:!o.isStoraged}])},[e("div",G,[(r(),l("svg",{onClick:u=>k(o.id),xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1",stroke:"currentColor",class:"w-6 h-6 cursor-pointer fill-red-500"},[ee,m(" /> ")],8,X))]),$(e("img",te,null,512),[[t,o.url]]),e("div",se,[e("div",ae,[e("span",oe,h(o.nominee),1),e("span",re,"／ "+h(o.work),1)]),e("p",le,h(o.awards),1)])],2))),128))]),g()?F("",!0):(r(),l("div",ne,"還沒收藏作品..."))]))])}}};export{de as default};
