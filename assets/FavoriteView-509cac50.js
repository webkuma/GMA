import{z as b,q as k,r as x,u as S,o as C,s as D,a as r,c as l,b as e,g,h as j,i as B,t as u,F as E,d as I,j as L,R,y as F,k as w,w as N}from"./index-8136bada.js";import{L as T}from"./Loading-f14f730f.js";import{i as v}from"./index-2f91c70e.js";const z="/GMA";let h=null;async function O(){if(h)return h;try{const o=await b({locateFile:s=>`https://sql.js.org/dist/${s}`}),d=fetch(`${z}/music.db`).then(s=>{if(!s.ok)throw new Error("Failed to fetch database file.");return s.arrayBuffer()}),[n,m]=await Promise.all([o,d]);return h=new n.Database(new Uint8Array(m)),h}catch(o){throw console.error("Database initialization failed:",o),o}}async function V(o){return(await O()).exec(`SELECT DISTINCT * FROM shortlist WHERE id IN (${o.join(", ")}) ORDER BY year DESC`)}const q={class:"text-white"},P={key:0,class:"absolute w-full h-full bg-[#202020] bg-opacity-90"},$={class:"flex items-center justify-center h-full"},M={key:1},A={class:"m-4 flex justify-between items-center"},G={class:"flex justify-between items-center p-3 text-gray-700 border border-gray-200 rounded-lg bg-gray-50","aria-label":"Breadcrumb"},H={class:"inline-flex items-center space-x-1 md:space-x-2 rtl:space-x-reverse"},W={class:"inline-flex items-center"},Y=e("a",{href:"#",class:"inline-flex items-center text-sm font-medium text-gray-700 hover:text-blue-600 dark:text-gray-400 dark:hover:text-white"},[e("svg",{class:"w-3 h-3 me-2","aria-hidden":"true",xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",viewBox:"0 0 20 20"},[e("path",{d:"m19.707 9.293-2-2-7-7a1 1 0 0 0-1.414 0l-7 7-2 2a1 1 0 0 0 1.414 1.414L2 10.414V18a2 2 0 0 0 2 2h3a1 1 0 0 0 1-1v-4a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1v4a1 1 0 0 0 1 1h3a2 2 0 0 0 2-2v-7.586l.293.293a1 1 0 0 0 1.414-1.414Z"})]),w(" 首頁 ")],-1),Z=e("li",null,[e("div",{class:"flex items-center"},[e("svg",{class:"rtl:rotate-180 block w-3 h-3 mx-1 text-gray-400","aria-hidden":"true",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 6 10"},[e("path",{stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"m1 9 4-4-4-4"})]),e("a",{class:"ms-1 text-sm font-medium text-gray-700 hover:text-blue-600 md:ms-2 dark:text-gray-400 dark:hover:text-white"}," 收藏 ")])],-1),J={class:"m-4"},K={class:"border-b-4 border-custom-gold"},Q=e("span",{class:"text-2xl"},"已收藏的作品",-1),U={class:"mx-6 mb-6 grid grid-cols-1 lg:grid-cols-2 gap-4"},X={class:"flex items-center justify-end mr-4"},ee=["onClick"],te=e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"m9.75 9.75 4.5 4.5m0-4.5-4.5 4.5M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"},null,-1),se={class:"mr-4 w-20 h-20 sm:w-32 sm:h-32 rounded-lg aspect-square",alt:""},oe={class:"flex flex-col justify-evenly pl-2"},ae={class:"text-base sm:text-xl font-semibold text-gray-700"},re={class:"text-base sm:text-xl font-semibold text-gray-700"},le={class:"text-base font-semibold text-gray-500"},ne={key:0,class:"p-4 flex flex-col items-center justify-center"},ie=e("p",{class:"text-6xl text-custom-gold"},"(='X'=)",-1),ce=e("p",{class:"text-2xl text-center pt-4"},"目前還沒有收藏作品",-1),de=[ie,ce],_e={__name:"FavoriteView",setup(o){const d=k(),n=x(1),m=S(),s=x();C(async()=>{n.value=1,await m.isReady(),_()});async function _(){let i=Object.keys(localStorage).filter(t=>t.startsWith("favoriteStorage-")).map(t=>parseInt(t.replace("favoriteStorage-",""),10));const c=await V(i);c[0]?s.value=c[0].values.map(t=>({id:t[0],awards:t[1],nominee:t[2],work:t[3],year:t[4],won:t[5],url:t[6]})):s.value=null,n.value=0}function p(i){s.value.forEach(c=>{if(c.id===i){v.success("已從收藏移除",{theme:"dark",autoClose:1e3,transition:"zoom",position:v.POSITION.TOP_RIGHT}),localStorage.removeItem(`favoriteStorage-${i}`),_(),d.updateYearsDataStorage(i,!1),f();return}})}function f(){return s.value?s.value.length:0}return(i,c)=>{const t=D("lazy");return r(),l("main",q,[n.value===1?(r(),l("div",P,[e("div",$,[g(T)])])):(r(),l("div",M,[e("div",A,[e("nav",G,[e("ol",H,[e("li",W,[g(B(R),{to:"/",class:"inline-block"},{default:j(()=>[Y]),_:1})]),Z])])]),e("div",J,[e("span",K,[Q,e("span",null," ("+u(f())+")",1)])]),e("div",U,[(r(!0),l(E,null,I(s.value,(a,y)=>(r(),l("div",{key:y,class:F(["flex shadow-custom-inner shadow-yellow-500 mt-4 p-4 border rounded-lg",{"bg-[#F5E8C7]":a.won,"bg-gray-200 ":!a.won}])},[e("div",X,[(r(),l("svg",{onClick:ue=>p(a.id),xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1",stroke:"currentColor",class:"w-6 h-6 cursor-pointer fill-red-500"},[te,w(" /> ")],8,ee))]),N(e("img",se,null,512),[[t,a.url]]),e("div",oe,[e("div",null,[e("span",ae,u(a.nominee),1),e("span",re,"／ "+u(a.work),1)]),e("p",le,u(a.awards),1)])],2))),128))]),f()?L("",!0):(r(),l("div",ne,de))]))])}}};export{_e as default};
